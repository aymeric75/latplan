Default float: float32
22
33
44
<function puzzle at 0x14f1f65225f0>
55
loaded. picsize: [48, 48]
(40000, 2, 48, 48, 1)
normalized shape: (48, 48, 1) (48, 48, 1)
<class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
config[hash]
8dd53f4ca49f65444250447a16903f86
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
in train 1
before
[None]
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x14f1f65cb590>
[0, 48, 48, 1] -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x14f1f65cb590>
<keras.layers.normalization.BatchNormalization object at 0x14f1cf1a9d90>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14f1cf1a9d90>
<keras.layers.core.Dropout object at 0x14f1cf1a9dd0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14f1cf1a9dd0>
<keras.layers.convolutional.Conv2D object at 0x14f1cf1a9d50>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x14f1cf1a9d50>
<keras.layers.normalization.BatchNormalization object at 0x14f1cf1af1d0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14f1cf1af1d0>
<keras.layers.core.Dropout object at 0x14f1cf1af210>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14f1cf1af210>
latent space shape is (48, 48, 32) : 300 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x14f1cf1af850>
[0, 48, 48, 32] -> (0, 48, 48, 32) : <keras.layers.core.Reshape object at 0x14f1cf1af850>
<keras.layers.convolutional.Conv2DTranspose object at 0x14f1cf1afbd0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x14f1cf1afbd0>
<keras.layers.normalization.BatchNormalization object at 0x14f1cf1afc90>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14f1cf1afc90>
<keras.layers.core.Dropout object at 0x14f1cf1aff50>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14f1cf1aff50>
<keras.layers.convolutional.Conv2DTranspose object at 0x14f1cf1b7510>
(0, 48, 48, 32) -> (0, 48, 48, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x14f1cf1b7510>
_build_primary_build_primary
Network built
self.build
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 48, 48, 1) 0                                            
__________________________________________________________________________________________________
lambda_6 (Lambda)               (None, 48, 48, 1)    0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_5 (Lambda)               (None, 48, 48, 1)    0           input_1[0][0]                    
__________________________________________________________________________________________________
gaussian_noise_1 (GaussianNoise (None, 48, 48, 1)    0           lambda_5[0][0]                   
                                                                 lambda_6[0][0]                   
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 48, 48, 32)   800         gaussian_noise_1[0][0]           
                                                                 gaussian_noise_1[1][0]           
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 48, 48, 32)   128         conv2d_1[0][0]                   
                                                                 conv2d_1[1][0]                   
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 48, 48, 32)   0           batch_normalization_2[0][0]      
                                                                 batch_normalization_2[1][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 48, 48, 32)   25600       dropout_2[0][0]                  
                                                                 dropout_2[1][0]                  
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 48, 48, 32)   128         conv2d_2[0][0]                   
                                                                 conv2d_2[1][0]                   
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 48, 48, 32)   0           batch_normalization_3[0][0]      
                                                                 batch_normalization_3[1][0]      
__________________________________________________________________________________________________
reshape_4 (Reshape)             (None, 73728)        0           dropout_3[0][0]                  
                                                                 dropout_3[1][0]                  
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 300)          22118700    reshape_4[0][0]                  
                                                                 reshape_4[1][0]                  
__________________________________________________________________________________________________
lambda_13 (Lambda)              (None, 300)          0           dense_5[0][0]                    
__________________________________________________________________________________________________
lambda_14 (Lambda)              (None, 300)          0           dense_5[1][0]                    
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 600)          0           lambda_13[0][0]                  
                                                                 lambda_14[0][0]                  
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1000)         600000      concatenate_1[0][0]              
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 1000)         4000        dense_1[0][0]                    
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 1000)         0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 6000)         6006000     dropout_1[0][0]                  
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1, 6000)      0           dense_2[0][0]                    
__________________________________________________________________________________________________
gumbel_softmax_1 (GumbelSoftmax (None, 1, 6000)      0           reshape_1[0][0]                  
__________________________________________________________________________________________________
my_flatten_1 (MyFlatten)        (None, 6000)         0           gumbel_softmax_1[0][0]           
__________________________________________________________________________________________________
my_flatten_2 (MyFlatten)        (None, 6000)         0           gumbel_softmax_1[0][0]           
__________________________________________________________________________________________________
binary_concrete_1 (BinaryConcre (None, 300)          0           dense_5[0][0]                    
                                                                 dense_5[1][0]                    
__________________________________________________________________________________________________
dense_7 (Dense)                 (None, 300)          1800000     my_flatten_1[0][0]               
__________________________________________________________________________________________________
dense_8 (Dense)                 (None, 300)          1800000     my_flatten_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 300)          1200        binary_concrete_1[1][0]          
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 300)          1200        dense_7[0][0]                    
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 300)          1200        binary_concrete_1[0][0]          
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 300)          1200        dense_8[0][0]                    
__________________________________________________________________________________________________
add_2 (Add)                     (None, 300)          0           batch_normalization_8[0][0]      
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
add_1 (Add)                     (None, 300)          0           batch_normalization_10[0][0]     
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
binary_concrete_3 (BinaryConcre (None, 300)          0           add_2[0][0]                      
__________________________________________________________________________________________________
binary_concrete_2 (BinaryConcre (None, 300)          0           add_1[0][0]                      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 300)          1200        binary_concrete_2[0][0]          
                                                                 binary_concrete_3[0][0]          
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 73728)        22192128    batch_normalization_4[2][0]      
                                                                 batch_normalization_4[3][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 73728)        294912      dense_6[2][0]                    
                                                                 dense_6[3][0]                    
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 73728)        0           batch_normalization_5[2][0]      
                                                                 batch_normalization_5[3][0]      
__________________________________________________________________________________________________
reshape_5 (Reshape)             (None, 48, 48, 32)   0           dropout_4[2][0]                  
                                                                 dropout_4[3][0]                  
__________________________________________________________________________________________________
conv2d_transpose_1 (Conv2DTrans (None, 48, 48, 32)   25600       reshape_5[2][0]                  
                                                                 reshape_5[3][0]                  
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 48, 48, 32)   128         conv2d_transpose_1[2][0]         
                                                                 conv2d_transpose_1[3][0]         
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 48, 48, 32)   0           batch_normalization_6[2][0]      
                                                                 batch_normalization_6[3][0]      
__________________________________________________________________________________________________
conv2d_transpose_2 (Conv2DTrans (None, 48, 48, 1)    801         dropout_5[2][0]                  
                                                                 dropout_5[3][0]                  
__________________________________________________________________________________________________
reshape_6 (Reshape)             (None, 48, 48, 1)    0           conv2d_transpose_2[2][0]         
                                                                 conv2d_transpose_2[3][0]         
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 48, 48, 1)    0           reshape_6[2][0]                  
                                                                 reshape_6[3][0]                  
__________________________________________________________________________________________________
lambda_17 (Lambda)              (None, 1, 48, 48, 1) 0           activation_1[3][0]               
__________________________________________________________________________________________________
lambda_18 (Lambda)              (None, 1, 48, 48, 1) 0           activation_1[2][0]               
__________________________________________________________________________________________________
dmerge_5 (Concatenate)          (None, 2, 48, 48, 1) 0           lambda_17[0][0]                  
                                                                 lambda_18[0][0]                  
==================================================================================================
Total params: 54,874,925
Trainable params: 54,722,277
Non-trainable params: 152,648
__________________________________________________________________________________________________
Building auxiliary networks
Auxiliary network built
self.build_aux
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 2, 48, 48, 1) 0                                            
__________________________________________________________________________________________________
lambda_6 (Lambda)               (None, 48, 48, 1)    0           input_1[0][0]                    
__________________________________________________________________________________________________
lambda_5 (Lambda)               (None, 48, 48, 1)    0           input_1[0][0]                    
__________________________________________________________________________________________________
gaussian_noise_1 (GaussianNoise (None, 48, 48, 1)    0           lambda_5[0][0]                   
                                                                 lambda_6[0][0]                   
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 48, 48, 32)   800         gaussian_noise_1[0][0]           
                                                                 gaussian_noise_1[1][0]           
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 48, 48, 32)   128         conv2d_1[0][0]                   
                                                                 conv2d_1[1][0]                   
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 48, 48, 32)   0           batch_normalization_2[0][0]      
                                                                 batch_normalization_2[1][0]      
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 48, 48, 32)   25600       dropout_2[0][0]                  
                                                                 dropout_2[1][0]                  
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 48, 48, 32)   128         conv2d_2[0][0]                   
                                                                 conv2d_2[1][0]                   
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 48, 48, 32)   0           batch_normalization_3[0][0]      
                                                                 batch_normalization_3[1][0]      
__________________________________________________________________________________________________
reshape_4 (Reshape)             (None, 73728)        0           dropout_3[0][0]                  
                                                                 dropout_3[1][0]                  
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 300)          22118700    reshape_4[0][0]                  
                                                                 reshape_4[1][0]                  
__________________________________________________________________________________________________
lambda_13 (Lambda)              (None, 300)          0           dense_5[0][0]                    
__________________________________________________________________________________________________
lambda_14 (Lambda)              (None, 300)          0           dense_5[1][0]                    
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 600)          0           lambda_13[0][0]                  
                                                                 lambda_14[0][0]                  
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1000)         600000      concatenate_1[0][0]              
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 1000)         4000        dense_1[0][0]                    
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 1000)         0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 6000)         6006000     dropout_1[0][0]                  
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1, 6000)      0           dense_2[0][0]                    
__________________________________________________________________________________________________
gumbel_softmax_1 (GumbelSoftmax (None, 1, 6000)      0           reshape_1[0][0]                  
__________________________________________________________________________________________________
my_flatten_1 (MyFlatten)        (None, 6000)         0           gumbel_softmax_1[0][0]           
__________________________________________________________________________________________________
my_flatten_2 (MyFlatten)        (None, 6000)         0           gumbel_softmax_1[0][0]           
__________________________________________________________________________________________________
binary_concrete_1 (BinaryConcre (None, 300)          0           dense_5[0][0]                    
                                                                 dense_5[1][0]                    
__________________________________________________________________________________________________
dense_7 (Dense)                 (None, 300)          1800000     my_flatten_1[0][0]               
__________________________________________________________________________________________________
dense_8 (Dense)                 (None, 300)          1800000     my_flatten_2[0][0]               
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 300)          1200        binary_concrete_1[1][0]          
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 300)          1200        dense_7[0][0]                    
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 300)          1200        binary_concrete_1[0][0]          
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 300)          1200        dense_8[0][0]                    
__________________________________________________________________________________________________
add_2 (Add)                     (None, 300)          0           batch_normalization_8[0][0]      
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
add_1 (Add)                     (None, 300)          0           batch_normalization_10[0][0]     
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
binary_concrete_3 (BinaryConcre (None, 300)          0           add_2[0][0]                      
__________________________________________________________________________________________________
binary_concrete_2 (BinaryConcre (None, 300)          0           add_1[0][0]                      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 300)          1200        binary_concrete_2[0][0]          
                                                                 binary_concrete_3[0][0]          
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 73728)        22192128    batch_normalization_4[2][0]      
                                                                 batch_normalization_4[3][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 73728)        294912      dense_6[2][0]                    
                                                                 dense_6[3][0]                    
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 73728)        0           batch_normalization_5[2][0]      
                                                                 batch_normalization_5[3][0]      
__________________________________________________________________________________________________
reshape_5 (Reshape)             (None, 48, 48, 32)   0           dropout_4[2][0]                  
                                                                 dropout_4[3][0]                  
__________________________________________________________________________________________________
conv2d_transpose_1 (Conv2DTrans (None, 48, 48, 32)   25600       reshape_5[2][0]                  
                                                                 reshape_5[3][0]                  
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 48, 48, 32)   128         conv2d_transpose_1[2][0]         
                                                                 conv2d_transpose_1[3][0]         
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 48, 48, 32)   0           batch_normalization_6[2][0]      
                                                                 batch_normalization_6[3][0]      
__________________________________________________________________________________________________
conv2d_transpose_2 (Conv2DTrans (None, 48, 48, 1)    801         dropout_5[2][0]                  
                                                                 dropout_5[3][0]                  
__________________________________________________________________________________________________
reshape_6 (Reshape)             (None, 48, 48, 1)    0           conv2d_transpose_2[2][0]         
                                                                 conv2d_transpose_2[3][0]         
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 48, 48, 1)    0           reshape_6[2][0]                  
                                                                 reshape_6[3][0]                  
__________________________________________________________________________________________________
lambda_17 (Lambda)              (None, 1, 48, 48, 1) 0           activation_1[3][0]               
__________________________________________________________________________________________________
lambda_18 (Lambda)              (None, 1, 48, 48, 1) 0           activation_1[2][0]               
__________________________________________________________________________________________________
dmerge_5 (Concatenate)          (None, 2, 48, 48, 1) 0           lambda_17[0][0]                  
                                                                 lambda_18[0][0]                  
==================================================================================================
Total params: 54,874,925
Trainable params: 54,722,277
Non-trainable params: 152,648
__________________________________________________________________________________________________
